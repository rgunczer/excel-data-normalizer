<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TAG Excel Importer</title>
    <script lang="javascript" src="node_modules/xlsx/dist/xlsx.full.min.js"></script>
    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="lib/FileSaver.min.js"></script>
    <link rel="stylesheet" href="node_modules/@fortawesome/fontawesome-free/css/all.min.css">
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <nav class="navbar navbar-dark bg-dark justify-content-start">
        <a class="navbar-brand" href="#"><i class="fas fa-file-import"></i>TAG Excel Importer</a>
        <form class="form-inline my-2 my-lg-0">
            <label class="btn btn-primary mr-sm-2">
                <input type="file" id="browse-excel-file" />
                <i class="far fa-file-excel"></i>Browse Excel File...
            </label>
            <button id="process" type="button" name="process" class="btn btn-primary mr-sm-2">
                <i id="processing-icon" class="fas fa-hammer"></i>
                Process
            </button>
            <div class="input-group mr-sm-2">
                <input type="text" class="form-control mr-sm-2" placeholder="api key">
                <button id="openGetEmpIdModal" type="button" name="openGetEmpIdModal" class="btn btn-primary">
                    Fetch Employee Ids
                </button>
            </div>
            <button id="btn-export-rules" type="button" name="export-rules" class="btn btn-primary mr-sm-2">
                <i class="fas fa-share"></i>Export Rules
            </button>
            <button id="btn-save-excel-file" type="button" name="btn-save-excel-file" class="btn btn-primary mr-sm-2">
                <i class="fas fa-file-download"></i>Save Excel File...
            </button>
        </form>
        <span class="navbar-text"></span>
    </nav>

    <div class="container-fluid px-0">
        <div id="excel"></div>
    </div>

    <div class="modal fade" id="columnModal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="columnModalLabel"></h5>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-5">
                            <div class="form-group">
                                <label for="distinct-values-list">Distinct Values</label>
                                <select id="distinct-values-list" class="form-control rule" size="20" multiple></select>
                            </div>
                        </div>
                        <div class="col-2">
                            <form>
                                <div class="form-group">
                                    <label>Rule</label>
                                    <div class="form-group">
                                        <button type="button" class="btn btn-light btn-sm" id="btn-rule-create-smart" name="btn-rule-create-smart">
                                            <i class="fas fa-bolt"></i>Smart
                                        </button>
                                    </div>
                                    <div class="form-group">
                                        <button type="button" class="btn btn-light btn-sm" id="btn-rule-add-from" name="btn-rule-add-from">
                                            <i class="fas fa-plus"></i>Add From
                                        </button>
                                    </div>
                                    <div class="form-group">
                                        <select id="rule-from" size="10" class="form-control" multiple></select>
                                    </div>
                                    <div class="form-group">
                                        <button type="button" class="btn btn-light btn-sm" id="btn-rule-add-to" name="btn-rule-add-to">
                                            <i class="fas fa-plus"></i>Add To
                                        </button>
                                    </div>
                                    <div class="form-group">
                                        <input id="rule-to" class="form-control" type="text">
                                    </div>
                                    <div class="form-group">
                                        <button type="button" class="btn btn-light btn-sm" id="btn-rule-create" name="btn-rule-create">
                                            <i class="fas fa-gavel"></i>Create Rule
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="col-5">
                            <div class="form-group">
                                <label for="existing-rules-list">Existing Rules</label>
                                <select id="existing-rules-list" class="form-control rule" size="20" multiple></select>
                                <button type="button" class="btn btn-light btn-sm" id="btn-rule-delete" name="btn-rule-delete">
                                    <i class="fas fa-trash-alt"></i>Delete Selected Rules
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="close-modal" name="close-modal-and-re-process">Close And Re-Process</button>
                    <button type="button" class="btn btn-secondary" id="close-modal" name="close-modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="collectEmpIdModal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="collectEmpIdModalLabel">Emplyee Id Harvester</h5>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-5">
                            Select Column:
                            <select id="column-list" class="form-control"></select>
                        </div>
                        <div class="col-5">
                            Column Values:
                            <select id="column-values" size="20" class="form-control"></select>
                        </div>
                    </div>
                    <button type="button" class="btn btn-secondary btn-sm" id="begin-getting-emp-ids" name="begin-getting-emp-ids">
                        <i class="fas fa-play"></i>Begin Getting Employee Ids
                    </button>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="export-to-excel-empids" name="export-to-excel-empids">
                        <i class="fas fa-file-download"></i>Export To Excel
                    </button>
                    <button type="button" class="btn btn-secondary" id="close-modal-empid" name="close-modal-empid">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="src/utils.js"></script>
    <script src="src/ui-utils.js"></script>
    <script src="src/excel.js"></script>
    <script src="src/api.js"></script>
    <script src="src/processor.js"></script>
    <script src="src/column-rules-modal.js"></script>
    <script src="src/employee-id-harvester-modal.js"></script>
    <script src="src/app.js"></script>

</body>

</html>
